@page "/travel-package-hotels"
@inject IHotelApiService HotelApiService
@using Shared.Models
@using TravelFusionLean.Components.Layout.Admin
@layout AdminLayout
@inject NavigationManager NavigationManager
@rendermode InteractiveServer

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<link href="css/CustomColors.css" rel="stylesheet" />

<div class="container mt-4">
    <h2 class="text-center">Choose Hotel</h2>
    
    <div class="card p-3 mb-3-3">
        <div class="row">
            <div class="col-md-3">
                <label>Location</label>
                <input type="text" class="form-control" placeholder="Enter location of hotel"/>
            </div>
            <!-- Yderligere informationer til s√∏gning af hotel -->
            <div class="col-md-3">
                <label>When:</label>
                <input type="text" class="form-control" placeholder="Select dates"/>
            </div>
            <div class="col-md-3">
                <label>Travellers:</label>
                <input type="text" class="form-control" placeholder="Enter number of travelers"/>
            </div>
            <div class="col-md-2">
                <label>Rooms:</label>
                <input type="text" class="form-control" placeholder="Number of rooms"/>
            </div>
            <div class="col-md-1 d-flex align-items-end">
                <button class="btn btn-primary w-100">üîç</button>
            </div>
        </div>


        <!-- Muligheder for at v√¶lge billig, hurtig eller bedst (kombination) -->
        <ul class="nav nav-tabs">
            <li class="nav-item">
                <a class="nav-link active" data-bs-toggle="tab" data-bs-target="#fastest" role="tab">Fastest</a>
            </li>
            <li class="nav-item">
                <a class="nav-link active" data-bs-toggle="tab" data-bs-target="#cheapest" role="tab">Cheapest</a>
            </li>
            <li class="nav-item">
                <a class="nav-link active" data-bs-toggle="tab" data-bs-target="#best" role="tab">Best</a>
            </li>
        </ul>

        
        <div class="tab-content">
            <div id="fastest" class="tab-pane fade show active p-3">
                @if (hotels == null)
                {
                    <p><em>Loading hotels...</em></p> <!-- OBS Colour -->
                }
                else if (!hotels.Any())
                {
                    <p>No hotels found.</p>
                }
                else
                {
                    @foreach (var hotel in hotels)
                    {
                        <div class="d-flex justify-content-between border p-2 mb-2">
                            <div>
                                <strong>@hotel.Address</strong>
                                @hotel.Name
                                @hotel.Description
                                -
                                @hotel.Price.ToString("0.00") @hotel.Currency?.Name
                            </div>
                        </div>
                    }
                }
                <div class="d-flex justify-content-between border p-2">
                    <div><strong></strong></div>
                    <button class="btn btn-primary">Select</button>
                </div>
            </div>
            <div id="cheapest" class="tab-pane fade show active p-3">
                <div class="d-flex justify-content-between border p-2">
                    <div><strong>DATA</strong> DATA DATA DATA</div>
                    <button class="btn btn-primary">Select</button>
                </div>
            </div>
            <div id="best" class="tab-pane fade show active p-3">
                <div class="d-flex justify-content-between border p-2">
                    <div><strong>DATA</strong> DATA DATA DATA</div>
                    <button class="btn btn-primary">Select</button>
                </div>
            </div>
        </div>

        
        <!-- Selected Hotel Summery -->
        <div class="card mt-3 p-3">
            <h5>Hotel</h5>
            <p>Description of hotel: </p>
            <p><strong>Total: [Price] euros</strong></p>
        </div>
    </div>
</div>

<div>
    <div>
        <button type="button" class="btn btn-primary" @onclick="GoToPublishTravelPackage" disabled="@(!CanProceed)">
            <i class="fa fa-bed"></i> Choose Hotel
        </button>
    </div>
</div>

@code{
    private bool CanProceed => selectedHotel != null;

    private List<Hotel>? hotels;
    private Hotel? selectedHotel;

    /// <summary>
    /// Kaldes ved indl√¶sning af siden og henter alle flights via service.
    /// </summary>
    protected override async Task OnInitializedAsync()
    {
        try
        {
            hotels = (await HotelApiService.GetAllHotelsAsync()).ToList();
        }
        catch (Exception ex)
        {
            Console.Error.WriteLine("Error loading hotels: " + ex.Message);
        }
    }

    
    private void SelectFlight(Hotel hotel)
    {
        selectedHotel = hotel;
    }

    private void GoToPublishTravelPackage()
    {
        NavigationManager.NavigateTo("/publish-travel-package");
    }
}
